<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stage1_Week1_Assignment</title>
    <link rel="stylesheet" href="assignment_week3.css"/>
</head>

<body>
    <script>

document.addEventListener('DOMContentLoaded', function() {
    let results = [];
    let displayedCount = 10; // 已經顯示的項目數量 (預設顯示前10個)
    const itemsPerLoad = 10; // 每次加載的項目數量

    function getData() {
        fetch("https://padax.github.io/taipei-day-trip-resources/taipei-attractions-assignment-1")
            .then(function(response) {
                return response.json();
            })
            .then(function(data) {
                if (data && data.data && data.data.results) {
                    results = data.data.results;
                    displayPromotionItems();
                    displayInitialItems();
                } else {
                    console.error('Data structure is incorrect or missing "results".');
                }
            })
            .catch(function(error) {
                console.error('Error:', error);
            });
    }

    function displayPromotionItems() {
        // 處理前三個結果，更新 promotion 的部分
        results.slice(0, 3).forEach(function(item, index) {
            let stitle = item.stitle;
            let firstImageUrl = getFirstImageUrl(item.filelist);

            // 如果未找到圖片，使用占位圖片
            if (!firstImageUrl) {
                firstImageUrl = 'https://via.placeholder.com/150';  // 使用占位圖片
            }

            // 更新圖片和標題
            let imgElement = document.querySelector(`.pro-con-${index + 1} img`);
            let titleElement = document.querySelector(`.pro-con-${index + 1} .promotion-text`);

            if (imgElement) {
                imgElement.src = firstImageUrl;
            }

            if (titleElement) {
                titleElement.textContent = stitle;
            }
        });
    }

    function displayInitialItems() {
        // 顯示第4到第10個項目
        displayItems(3, 13);
    }

    function displayItems(startIndex, endIndex) {
        results.slice(startIndex, endIndex).forEach(function(item, index) {
            let stitle = item.stitle || "No Title Available";
            let firstImageUrl = getFirstImageUrl(item.filelist);

            // 如果未找到圖片，使用占位圖片
            if (!firstImageUrl) {
                firstImageUrl = 'https://via.placeholder.com/150';  // 使用占位圖片
            }

            createCard(startIndex + index + 1, firstImageUrl, stitle);
        });

        displayedCount = endIndex; // 更新已顯示的項目數量
    }

    function getFirstImageUrl(filelist) {
        if (filelist && typeof filelist === "string") {
            let match = filelist.match(/https?:\/\/\S+?\.(jpg|jpeg|png|gif)/i);
            if (match) {
                return match[0];
            }
        }
        return '';
    }

    function createCard(index, imageUrl, title) {
        let gridContainer = document.querySelector('.row-grid');

        let cardElement = document.createElement('div');
        cardElement.classList.add('card', `title${index}`);

        let imageContainer = document.createElement('div');
        imageContainer.classList.add('image-container');

        let imgElement = document.createElement('img');
        imgElement.classList.add('image');
        imgElement.src = imageUrl;

        let starElement = document.createElement('img');
        starElement.classList.add('star');
        starElement.src = './image/star.png';

        let titleElement = document.createElement('div');
        titleElement.classList.add('card-title');
        titleElement.textContent = title;

        imageContainer.appendChild(imgElement);
        imageContainer.appendChild(starElement);
        cardElement.appendChild(imageContainer);
        cardElement.appendChild(titleElement);

        gridContainer.appendChild(cardElement);
    }

    document.querySelector('.btn').addEventListener('click', function() {
        let nextStartIndex = displayedCount;
        let nextEndIndex = displayedCount + itemsPerLoad;

        if (nextStartIndex < results.length) {
            displayItems(nextStartIndex, Math.min(nextEndIndex, results.length));

            // 檢查是否顯示完所有項目，如果是，隱藏按鈕
            if (nextEndIndex >= results.length) {
                document.querySelector('.btn').style.display = 'none';
            }
        }
    });

    getData();
});














        document.addEventListener("DOMContentLoaded", function() {
            const menuButton = document.querySelector(".menu");
            const closeButton = document.querySelector(".close");
            const asideMenu = document.querySelector(".aside-menu");

            menuButton.addEventListener("click", function() {
                asideMenu.classList.toggle("active");
            });

            closeButton.addEventListener("click", function() {
                asideMenu.classList.remove("active");
            });
        });



    </script>




    <nav>
        <!-- 左側導覽區 -->
        <div class="left-nav">My Website</div>
        <!-- 右側導覽區 -->
        <div class="right-nav ">
            <div>Item 1</div>
            <div>Item 2</div>
            <div>Item 3</div>
            <div>Item 4</div>
        </div>
        <img class="menu" src="./image/burger-menu.png" ></img>
    </nav>

    <div class="aside-menu">
        <img class="close" src="./image/close.png"/>
        <div class="aside-item">Item 1</div>
        <div class="aside-item">Item 2</div>
        <div class="aside-item">Item 3</div>
        <div class="aside-item">Item 4</div>
    </div>

    <!-- 主內容區 -->
    <div class="title">
        <div class="text">Welcome to MyHome</div>
    </div>

    <div class="image-content">
            <div class="promotion">
                <div class="pro-con-1" style="display: flex;">
                    <img></img>
                    <div class="promotion-text middle-screen1"></div>
                </div>
                <div class="pro-con-2" style="display: flex;">
                    <img></img>
                    <div class="promotion-text middle-screen2"></div>
                </div>
                <div class="pro-con-3" style="display: flex;">
                    <img></img>
                    <div class="promotion-text middle-screen3"></div>
                </div>
            </div>

                <div class="row-grid"></div>
                <div class="btn">Load More</div>
    </div>




</body>
</html>
